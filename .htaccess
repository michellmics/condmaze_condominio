RewriteEngine On

# Reescreve URLs removendo o .php
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.+)$ $1.php [L,QSA]

# Impede o acesso direto ao .php pela URL digitada
RewriteCond %{THE_REQUEST} \s/+(.+?)\.php[\s?] [NC]
RewriteRule ^ /%1 [R=301,L]

# Bloqueia acesso ao diretório objects
RewriteRule ^objects/.*$ - [F,L]

# Protege arquivos sensíveis
<FilesMatch "\.(htaccess|htpasswd|ini|log|sh)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Protege arquivos individuais
<Files .htaccess>
    Order Allow,Deny
    Deny from all
</Files>

<Files objects/objects.php>
    Order Allow,Deny
    Deny from all
</Files>

<Files objects/objects_chart.php>
    Order Allow,Deny
    Deny from all
</Files>
